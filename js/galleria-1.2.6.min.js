!function(t){var e,i=this,n=i.document,a=t(n),o=t(i),r=!0,s=3e4,l=!1,c=navigator.userAgent.toLowerCase(),h=i.location.hash.replace(/#\//,""),u=function(){var t=3,e=n.createElement("div"),i=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(i[0]);return t>4?t:void 0}(),d=function(){return{html:n.documentElement,body:n.body,head:n.getElementsByTagName("head")[0],title:n.title}},p=(e=[],t.each("data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image".split(" "),(function(t,i){e.push(i),/_/.test(i)&&e.push(i.replace(/_/g,""))})),e),g=function(e){var i;return"object"!=typeof e||t.each(e,(function(n,a){/^[a-z]+_/.test(n)&&(i="",t.each(n.split("_"),(function(t,e){i+=t>0?e.substr(0,1).toUpperCase()+e.substr(1):e})),e[i]=a,delete e[n])})),e},f=function(e){return t.inArray(e,p)>-1?Galleria[e.toUpperCase()]:e},m={trunk:{},add:function(t,e,n,a){if(a=a||!1,this.clear(t),a){var o=e;e=function(){o(),m.add(t,e,n)}}this.trunk[t]=i.setTimeout(e,n)},clear:function(t){var e,n=function(t){i.clearTimeout(this.trunk[t]),delete this.trunk[t]};if(t&&t in this.trunk)n.call(m,t);else if(void 0===t)for(e in this.trunk)this.trunk.hasOwnProperty(e)&&n.call(m,e)}},y=[],v=[],b=!1,_=!1,x=[],w=function(e){Galleria.theme=e,t.each(x,(function(t,e){e._initialized||e._init.call(e)}))},T={array:function(t){return Array.prototype.slice.call(t,0)},create:function(t,e){var i=n.createElement(e||"div");return i.className=t,i},getScriptPath:function(e){return 1==(e=(e=e||t("script:last").attr("src")).split("/")).length?"":(e.pop(),e.join("/")+"/")},animate:function(){var e,a,o,r,s,l,c,h=function(t){var e,n="transition WebkitTransition MozTransition OTransition".split(" ");if(i.opera)return!1;for(e=0;n[e];e++)if(void 0!==t[n[e]])return n[e];return!1}((n.body||n.documentElement).style),u={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[h],d={_default:[.25,.1,.25,1],galleria:[.645,.045,.355,1],galleriaIn:[.55,.085,.68,.53],galleriaOut:[.25,.46,.45,.94],ease:[.25,0,.25,1],linear:[.25,.25,.75,.75],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},p=function(e,i,n){var a={};n=n||"transition",t.each("webkit moz ms o".split(" "),(function(){a["-"+this+"-"+n]=i})),e.css(a)},g=function(t){p(t,"none","transition"),Galleria.WEBKIT&&Galleria.TOUCH&&(p(t,"translate3d(0,0,0)","transform"),t.data("revert")&&(t.css(t.data("revert")),t.data("revert",null)))};return function(n,f,m){m=t.extend({duration:400,complete:function(){},stop:!1},m),n=t(n),m.duration?h?(m.stop&&(n.unbind(u),g(n)),e=!1,t.each(f,(function(t,i){c=n.css(t),T.parseValue(c)!=T.parseValue(i)&&(e=!0),n.css(t,c)})),e?(a=[],o=m.easing in d?d[m.easing]:d._default,r=" "+m.duration+"ms cubic-bezier("+o.join(",")+")",i.setTimeout((function(){n.one(u,function(t){return function(){g(t),m.complete.call(t[0])}}(n)),Galleria.WEBKIT&&Galleria.TOUCH&&(s={},l=[0,0,0],t.each(["left","top"],(function(t,e){e in f&&(l[t]=T.parseValue(f[e])-T.parseValue(n.css(e))+"px",s[e]=f[e],delete f[e])})),l[0]||l[1])&&(n.data("revert",s),a.push("-webkit-transform"+r),p(n,"translate3d("+l.join(",")+")","transform")),t.each(f,(function(t){a.push(t+r)})),p(n,a.join(",")),n.css(f)}),1)):i.setTimeout((function(){m.complete.call(n[0])}),m.duration)):n.animate(f,m):(n.css(f),m.complete.call(n[0]))}}(),removeAlpha:function(t){if(u<9&&t){var e=t.style;t=(t=t.currentStyle)&&t.filter||e.filter||"",/alpha/.test(t)&&(e.filter=t.replace(/alpha\([^)]*\)/i,""))}},forceStyles:function(e,i){(e=t(e)).attr("style")&&e.data("styles",e.attr("style")).removeAttr("style"),e.css(i)},revertStyles:function(){t.each(T.array(arguments),(function(e,i){(i=t(i)).removeAttr("style"),i.attr("style",""),i.data("styles")&&i.attr("style",i.data("styles")).data("styles",null)}))},moveOut:function(t){T.forceStyles(t,{position:"absolute",left:-1e4})},moveIn:function(){T.revertStyles.apply(T,T.array(arguments))},elem:function(e){return e instanceof t?{$:e,dom:e[0]}:{$:t(e),dom:e}},hide:function(t,e,i){i=i||function(){};var n=T.elem(t),a=n.$;t=n.dom,a.data("opacity")||a.data("opacity",a.css("opacity")),n={opacity:0},e?T.animate(t,n,{duration:e,complete:u<9&&t?function(){T.removeAlpha(t),t.style.visibility="hidden",i.call(t)}:i,stop:!0}):u<9&&t?(T.removeAlpha(t),t.style.visibility="hidden"):a.css(n)},show:function(t,e,i){i=i||function(){};var n=T.elem(t),a=n.$,o=(t=n.dom,{opacity:parseFloat(a.data("opacity"))||1});e?(u<9&&(a.css("opacity",0),t.style.visibility="visible"),T.animate(t,o,{duration:e,complete:u<9&&t?function(){1==o.opacity&&T.removeAlpha(t),i.call(t)}:i,stop:!0})):u<9&&1==o.opacity&&t?(T.removeAlpha(t),t.style.visibility="visible"):a.css(o)},optimizeTouch:function(){var e,i,n,a,o={},r=function(e){e.preventDefault(),o=t.extend({},e,!0)},s=function(){this.evt=o},l=function(){this.handler.call(e,this.evt)};return function(o){t(o).bind("touchend",(function(o){for(e=o.target,a=!0;e.parentNode&&e!=o.currentTarget&&a;)i=t(e).data("events"),n=t(e).data("fakes"),i&&"click"in i?(a=!1,o.preventDefault(),t(e).click(r).click(),i.click.pop(),t.each(i.click,s),t(e).data("fakes",i.click),delete i.click):n&&(a=!1,o.preventDefault(),t.each(n,l)),e=e.parentNode}))}}(),addTimer:function(){return m.add.apply(m,T.array(arguments)),this},clearTimer:function(){return m.clear.apply(m,T.array(arguments)),this},wait:function(e){e=t.extend({until:function(){return!1},success:function(){},error:function(){Galleria.raise("Could not complete wait function.")},timeout:3e3},e);var n,a,o=T.timestamp(),r=function(){return a=T.timestamp(),n=a-o,e.until(n)?(e.success(),!1):a>=o+e.timeout?(e.error(),!1):void i.setTimeout(r,10)};i.setTimeout(r,10)},toggleQuality:function(t,e){7!==u&&8!==u||!t||(void 0===e&&(e="nearest-neighbor"===t.style.msInterpolationMode),t.style.msInterpolationMode=e?"bicubic":"nearest-neighbor")},insertStyleTag:function(t){var e=n.createElement("style");d().head.appendChild(e),e.styleSheet?e.styleSheet.cssText=t:(t=n.createTextNode(t),e.appendChild(t))},loadScript:function(e,i){var n=!1,a=t("<script>").attr({src:e,async:!0}).get(0);a.onload=a.onreadystatechange=function(){n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n=!0,a.onload=a.onreadystatechange=null,"function"==typeof i&&i.call(this,this))},d().head.appendChild(a)},parseValue:function(t){return"number"==typeof t?t:"string"==typeof t&&(t=t.match(/\-?\d|\./g))&&t.constructor===Array?1*t.join(""):0},timestamp:function(){return(new Date).getTime()},loadCSS:function(e,a,o){var r,s,l=!1;return t("link[rel=stylesheet]").each((function(){if(RegExp(e).test(this.href))return r=this,!1})),"function"==typeof a&&(o=a,a=void 0),o=o||function(){},r?(o.call(r,r),r):(s=n.styleSheets.length,t("#"+a).length?(t("#"+a).attr("href",e),s--,l=!0):(r=t("<link>").attr({rel:"stylesheet",href:e,id:a}).get(0),i.setTimeout((function(){var i=t('link[rel="stylesheet"], style');i.length?i.get(0).parentNode.insertBefore(r,i[0]):d().head.appendChild(r),u?s>=31?Galleria.raise("You have reached the browser stylesheet limit (31)",!0):r.onreadystatechange=function(){l||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(l=!0)}:/file:\/\//i.test(e)?l=!0:t.ajax({url:e,success:function(){l=!0},error:function(t){t.isRejected()&&Galleria.WEBKIT&&(l=!0)}})}),10)),"function"==typeof o&&T.wait({until:function(){return l&&n.styleSheets.length>s},success:function(){i.setTimeout((function(){o.call(r,r)}),100)},error:function(){Galleria.raise("Theme CSS could not load",!0)},timeout:1e4}),r)}},k=function(){var e=function(e,i,n,a){var o=this.getOptions("easing"),r=this.getStageWidth(),s={left:r*(e.rewind?-1:1)},l={left:0};n?(s.opacity=0,l.opacity=1):s.opacity=1,t(e.next).css(s),T.animate(e.next,l,{duration:e.speed,complete:function(t){return function(){i(),t.css({left:0})}}(t(e.next).add(e.prev)),queue:!1,easing:o}),a&&(e.rewind=!e.rewind),e.prev&&(s={left:0},l={left:r*(e.rewind?1:-1)},n&&(s.opacity=1,l.opacity=0),t(e.prev).css(s),T.animate(e.prev,l,{duration:e.speed,queue:!1,easing:o,complete:function(){t(this).css("opacity",0)}}))};return{fade:function(e,i){t(e.next).css({opacity:0,left:0}).show(),T.animate(e.next,{opacity:1},{duration:e.speed,complete:i}),e.prev&&(t(e.prev).css("opacity",1).show(),T.animate(e.prev,{opacity:0},{duration:e.speed}))},flash:function(e,i){t(e.next).css({opacity:0,left:0}),e.prev?T.animate(e.prev,{opacity:0},{duration:e.speed/2,complete:function(){T.animate(e.next,{opacity:1},{duration:e.speed,complete:i})}}):T.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},pulse:function(e,i){e.prev&&t(e.prev).hide(),t(e.next).css({opacity:0,left:0}).show(),T.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},slide:function(t,i){e.apply(this,T.array(arguments))},fadeslide:function(t,i){e.apply(this,T.array(arguments).concat([!0]))},doorslide:function(t,i){e.apply(this,T.array(arguments).concat([!1,!0]))}}}();Galleria=function(){var e=this;this._theme=void 0,this._options={},this._playing=!1,this._playtime=5e3,this._active=null,this._queue={length:0},this._data=[],this._dom={},this._thumbnails=[],this._layers=[],this._firstrun=this._initialized=!1,this._stageHeight=this._stageWidth=0,this._target=void 0,this._id=Math.random(),t.each("container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip".split(" "),(function(t,i){e._dom[i]=T.create("galleria-"+i)})),t.each("current total".split(" "),(function(t,i){e._dom[i]=T.create("galleria-"+i,"span")}));var n=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(t){var i=t.keyCode||t.which;i in n.map&&"function"==typeof n.map[i]&&n.map[i].call(e,t)},attach:function(t){var e,i;for(e in t)t.hasOwnProperty(e)&&((i=e.toUpperCase())in n.keys?n.map[n.keys[i]]=t[e]:n.map[i]=t[e]);n.bound||(n.bound=!0,a.bind("keydown",n.press))},detach:function(){n.bound=!1,n.map={},a.unbind("keydown",n.press)}},r=this._controls={0:void 0,1:void 0,active:0,swap:function(){r.active=r.active?0:1},getActive:function(){return r[r.active]},getNext:function(){return r[1-r.active]}},s=this._carousel={next:e.$("thumb-nav-right"),prev:e.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var i=0,n=0,a=[0];t.each(e._thumbnails,(function(e,o){o.ready&&(i+=o.outerWidth||t(o.container).outerWidth(!0),a[e+1]=i,n=Math.max(n,o.outerHeight||t(o.container).outerHeight(!0)))})),e.$("thumbnails").css({width:i,height:n}),s.max=i,s.hooks=a,s.width=e.$("thumbnails-list").width(),s.setClasses(),e.$("thumbnails-container").toggleClass("galleria-carousel",i>s.width),s.width=e.$("thumbnails-list").width()},bindControls:function(){var t;s.next.bind("click",(function(i){if(i.preventDefault(),"auto"===e._options.carouselSteps){for(t=s.current;t<s.hooks.length;t++)if(s.hooks[t]-s.hooks[s.current]>s.width){s.set(t-2);break}}else s.set(s.current+e._options.carouselSteps)})),s.prev.bind("click",(function(i){if(i.preventDefault(),"auto"===e._options.carouselSteps)for(t=s.current;t>=0;t--){if(s.hooks[s.current]-s.hooks[t]>s.width){s.set(t+2);break}if(0===t){s.set(0);break}}else s.set(s.current-e._options.carouselSteps)}))},set:function(t){for(t=Math.max(t,0);s.hooks[t-1]+s.width>=s.max&&t>=0;)t--;s.current=t,s.animate()},getLast:function(t){return(t||s.current)-1},follow:function(t){if(0===t||t===s.hooks.length-2)s.set(t);else{for(var e=s.current;s.hooks[e]-s.hooks[s.current]<s.width&&e<=s.hooks.length;)e++;t-1<s.current?s.set(t-1):t+2>e&&s.set(t-e+s.current+2)}},setClasses:function(){s.prev.toggleClass("disabled",!s.current),s.next.toggleClass("disabled",s.hooks[s.current]+s.width>=s.max)},animate:function(){s.setClasses();var t=-1*s.hooks[s.current];isNaN(t)||T.animate(e.get("thumbnails"),{left:t},{duration:e._options.carouselSpeed,easing:e._options.easing,queue:!1})}},l=this._tooltip={initialized:!1,open:!1,init:function(){l.initialized=!0,T.insertStyleTag(".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}"),e.$("tooltip").css("opacity",.8),T.hide(e.get("tooltip"))},move:function(t){var i=e.getMousePosition(t).x,n=(t=e.getMousePosition(t).y,e.$("tooltip")),a=t,o=n.outerHeight(!0)+1,r=n.outerWidth(!0),s=o+15;r=e.$("container").width()-r-2,o=e.$("container").height()-o-2;!isNaN(i)&&!isNaN(a)&&(i+=10,a-=30,i=Math.max(0,Math.min(r,i)),a=Math.max(0,Math.min(o,a)),t<s&&(a=s),n.css({left:i,top:a}))},bind:function(i,n){if(!Galleria.TOUCH){l.initialized||l.init();var a=function(i,n){l.define(i,n),t(i).hover((function(){T.clearTimer("switch_tooltip"),e.$("container").unbind("mousemove",l.move).bind("mousemove",l.move).trigger("mousemove"),l.show(i),Galleria.utils.addTimer("tooltip",(function(){e.$("tooltip").stop().show().animate({opacity:1}),l.open=!0}),l.open?0:500)}),(function(){e.$("container").unbind("mousemove",l.move),T.clearTimer("tooltip"),e.$("tooltip").stop().animate({opacity:0},200,(function(){e.$("tooltip").hide(),T.addTimer("switch_tooltip",(function(){l.open=!1}),1e3)}))}))};"string"==typeof n?a(i in e._dom?e.get(i):i,n):t.each(i,(function(t,i){a(e.get(t),i)}))}},show:function(n){var a=(n=t(n in e._dom?e.get(n):n)).data("tt"),o=function(t){i.setTimeout(function(t){return function(){l.move(t)}}(t),10),n.unbind("mouseup",o)};(a="function"==typeof a?a():a)&&(e.$("tooltip").html(a.replace(/\s/,"&nbsp;")),n.bind("mouseup",o))},define:function(i,n){if("function"!=typeof n){var a=n;n=function(){return a}}i=t(i in e._dom?e.get(i):i).data("tt",n),l.show(i)}},c=this._fullscreen={scrolled:0,crop:void 0,transition:void 0,active:!1,keymap:e._keyboard.map,enter:function(i){c.active=!0,T.hide(e.getActiveImage()),e.$("container").addClass("fullscreen"),c.scrolled=o.scrollTop(),T.forceStyles(e.get("container"),{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4});var n={height:"100%",overflow:"hidden",margin:0,padding:0},a=e.getData(),r=e._options;if(T.forceStyles(d().html,n),T.forceStyles(d().body,n),c.keymap=t.extend({},e._keyboard.map),e.attachKeyboard({escape:e.exitFullscreen,right:e.next,left:e.prev}),c.crop=r.imageCrop,null!=r.fullscreenCrop&&(r.imageCrop=r.fullscreenCrop),a&&a.big&&a.image!==a.big){var s=(n=new Galleria.Picture).isCached(a.big),l=e.getIndex(),h=e._thumbnails[l];e.trigger({type:Galleria.LOADSTART,cached:s,rewind:!1,index:l,imageTarget:e.getActiveImage(),thumbTarget:h}),n.load(a.big,(function(i){e._scaleImage(i,{complete:function(i){e.trigger({type:Galleria.LOADFINISH,cached:s,index:l,rewind:!1,imageTarget:i.image,thumbTarget:h});var n=e._controls.getActive().image;n&&t(n).width(i.image.width).height(i.image.height).attr("style",t(i.image).attr("style")).attr("src",i.image.src)}})}))}e.rescale((function(){T.addTimer("fullscreen_enter",(function(){T.show(e.getActiveImage()),"function"==typeof i&&i.call(e)}),100),e.trigger(Galleria.FULLSCREEN_ENTER)})),o.resize((function(){c.scale()}))},scale:function(){e.rescale()},exit:function(t){c.active=!1,T.hide(e.getActiveImage()),e.$("container").removeClass("fullscreen"),T.revertStyles(e.get("container"),d().html,d().body),i.scrollTo(0,c.scrolled),e.detachKeyboard(),e.attachKeyboard(c.keymap),e._options.imageCrop=c.crop;var n=e.getData().big,a=e._controls.getActive().image;n&&n==a.src&&i.setTimeout(function(t){return function(){a.src=t}}(e.getData().image),1),e.rescale((function(){T.addTimer("fullscreen_exit",(function(){T.show(e.getActiveImage()),"function"==typeof t&&t.call(e)}),50),e.trigger(Galleria.FULLSCREEN_EXIT)})),o.unbind("resize",c.scale)}},h=this._idle={trunk:[],bound:!1,add:function(e,i){if(e){h.bound||h.addEvent();e=t(e);var n,a={};for(n in i)i.hasOwnProperty(n)&&(a[n]=e.css(n));e.data("idle",{from:a,to:i,complete:!0,busy:!1}),h.addTimer(),h.trunk.push(e)}},remove:function(i){i=jQuery(i),t.each(h.trunk,(function(t,n){n.length&&!n.not(i).length&&(e._idle.show(i),e._idle.trunk.splice(t,1))})),h.trunk.length||(h.removeEvent(),T.clearTimer("idle"))},addEvent:function(){h.bound=!0,e.$("container").bind("mousemove click",h.showAll)},removeEvent:function(){h.bound=!1,e.$("container").unbind("mousemove click",h.showAll)},addTimer:function(){T.addTimer("idle",(function(){e._idle.hide()}),e._options.idleTime)},hide:function(){e._options.idleMode&&(e.trigger(Galleria.IDLE_ENTER),t.each(h.trunk,(function(t,i){var n=i.data("idle");n&&(i.data("idle").complete=!1,T.animate(i,n.to,{duration:e._options.idleSpeed}))})))},showAll:function(){T.clearTimer("idle"),t.each(e._idle.trunk,(function(t,i){e._idle.show(i)}))},show:function(i){var n=i.data("idle");n.busy||n.complete||(n.busy=!0,e.trigger(Galleria.IDLE_EXIT),T.clearTimer("idle"),T.animate(i,n.from,{duration:e._options.idleSpeed/2,complete:function(){t(this).data("idle").busy=!1,t(this).data("idle").complete=!0}})),h.addTimer()}},p=this._lightbox={width:0,height:0,initialized:!1,active:null,image:null,elems:{},keymap:!1,init:function(){if(e.trigger(Galleria.LIGHTBOX_OPEN),!p.initialized){p.initialized=!0;var i={},n=e._options,a="",o=(n={overlay:"position:fixed;display:none;opacity:"+n.overlayOpacity+";filter:alpha(opacity="+100*n.overlayOpacity+");top:0;left:0;width:100%;height:100%;background:"+n.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:"position:absolute;background:#000;width:100%;height:100%;",content:"position:absolute;background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:"position:absolute;bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:"position:absolute;top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:"position:absolute;top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:"position:absolute;width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:"position:absolute;width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:"position:absolute;top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:"position:absolute;top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},{});8===u&&(n.nextholder+="background:#000;filter:alpha(opacity=0);",n.prevholder+="background:#000;filter:alpha(opacity=0);"),t.each(n,(function(t,e){a+=".galleria-lightbox-"+t+"{"+e+"}"})),T.insertStyleTag(a),t.each("overlay box content shadow title info close prevholder prev nextholder next counter image".split(" "),(function(t,n){e.addElement("lightbox-"+n),i[n]=p.elems[n]=e.get("lightbox-"+n)})),p.image=new Galleria.Picture,t.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},(function(e,i){var n=[];t.each(i.split(" "),(function(t,e){n.push("lightbox-"+e)})),o["lightbox-"+e]=n})),e.append(o),t(i.image).append(p.image.container),t(d().body).append(i.overlay,i.box),T.optimizeTouch(i.box),function(e){e.hover((function(){t(this).css("color","#bbb")}),(function(){t(this).css("color","#444")}))}(t(i.close).bind("click",p.hide).html("&#215;")),t.each(["Prev","Next"],(function(e,n){var a=t(i[n.toLowerCase()]).html(/v/.test(n)?"&#8249;&nbsp;":"&nbsp;&#8250;"),o=t(i[n.toLowerCase()+"holder"]);o.bind("click",(function(){p["show"+n]()})),u<8||Galleria.TOUCH?a.show():o.hover((function(){a.show()}),(function(){a.stop().fadeOut(200)}))})),t(i.overlay).bind("click",p.hide),Galleria.IPAD&&(e._options.lightboxTransitionSpeed=0)}},rescale:function(i){var n=Math.min(o.width()-40,p.width),a=Math.min(o.height()-60,p.height);a=Math.min(n/p.width,a/p.height),n={width:n=Math.round(p.width*a)+40,height:a=Math.round(p.height*a)+60,"margin-top":-1*Math.ceil(a/2),"margin-left":-1*Math.ceil(n/2)};i?t(p.elems.box).css(n):t(p.elems.box).animate(n,{duration:e._options.lightboxTransitionSpeed,easing:e._options.easing,complete:function(){var i=p.image,n=e._options.lightboxFadeSpeed;e.trigger({type:Galleria.LIGHTBOX_IMAGE,imageTarget:i.image}),t(i.container).show(),T.show(i.image,n),T.show(p.elems.info,n)}})},hide:function(){p.image.image=null,o.unbind("resize",p.rescale),t(p.elems.box).hide(),T.hide(p.elems.info),e.detachKeyboard(),e.attachKeyboard(p.keymap),p.keymap=!1,T.hide(p.elems.overlay,200,(function(){t(this).hide().css("opacity",e._options.overlayOpacity),e.trigger(Galleria.LIGHTBOX_CLOSE)}))},showNext:function(){p.show(e.getNext(p.active))},showPrev:function(){p.show(e.getPrev(p.active))},show:function(i){p.active=i="number"==typeof i?i:e.getIndex(),p.initialized||p.init(),p.keymap||(p.keymap=t.extend({},e._keyboard.map),e.attachKeyboard({escape:p.hide,right:p.showNext,left:p.showPrev})),o.unbind("resize",p.rescale);var n,a,r,s=e.getData(i),l=e.getDataLength(),c=e.getNext(i);T.hide(p.elems.info);try{for(r=e._options.preload;r>0;r--)a=new Galleria.Picture,n=e.getData(c),a.preload("big"in n?n.big:n.image),c=e.getNext(c)}catch(t){}p.image.load(s.big||s.image,(function(e){p.width=e.original.width,p.height=e.original.height,t(e.image).css({width:"100.5%",height:"100.5%",top:0,zIndex:99998}),T.hide(e.image),p.elems.title.innerHTML=s.title||"",p.elems.counter.innerHTML=i+1+" / "+l,o.resize(p.rescale),p.rescale()})),t(p.elems.overlay).show(),t(p.elems.box).show()}};return this},Galleria.prototype={constructor:Galleria,init:function(e,i){if(i=g(i),this._original={target:e,options:i,data:null},this._target=this._dom.target=e.nodeName?e:t(e).get(0),v.push(this),this._target)return this._options={autoplay:!1,carousel:!0,carouselFollow:!0,carouselSpeed:400,carouselSteps:"auto",clicknext:!1,dataConfig:function(){return{}},dataSelector:"img",dataSource:this._target,debug:void 0,dummy:void 0,easing:"galleria",extend:function(){},fullscreenCrop:void 0,fullscreenDoubleTap:!0,fullscreenTransition:void 0,height:"auto",idleMode:!0,idleTime:3e3,idleSpeed:200,imageCrop:!1,imageMargin:0,imagePan:!1,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:void 0,initialTransition:void 0,keepSource:!1,layerFollow:!0,lightbox:!1,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:!0,maxScaleRatio:void 0,minScaleRatio:void 0,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:!0,popupLinks:!1,preload:2,queue:!0,show:0,showInfo:!0,showCounter:!0,showImagenav:!0,swipe:!0,thumbCrop:!0,thumbEventType:"click",thumbFit:!0,thumbMargin:0,thumbQuality:"auto",thumbnails:!0,touchTransition:void 0,transition:"fade",transitionInitial:void 0,transitionSpeed:400,useCanvas:!1,width:"auto"},this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial,i&&!1===i.debug&&(r=!1),i&&"number"==typeof i.imageTimeout&&(s=i.imageTimeout),i&&"string"==typeof i.dummy&&(l=i.dummy),t(this._target).children().hide(),"object"==typeof Galleria.theme?this._init():x.push(this),this;Galleria.raise("Target not found.",!0)},_init:function(){var e=this,a=this._options;if(this._initialized)return Galleria.raise("Init failed: Gallery instance already initialized."),this;if(this._initialized=!0,!Galleria.theme)return Galleria.raise("Init failed: No theme found."),this;if(t.extend(!0,a,Galleria.theme.defaults,this._original.options),function(t){"getContext"in t&&(_=_||{elem:t,context:t.getContext("2d"),cache:{},length:0})}(n.createElement("canvas")),this.bind(Galleria.DATA,(function(){Galleria.QUIRK&&Galleria.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML."),this._original.data=this._data,this.get("total").innerHTML=this.getDataLength();var n=this.$("container"),o={width:0,height:0},r=function(){return e.$("stage").height()};T.wait({until:function(){return t.each(["width","height"],(function(t,i){o[i]=a[i]&&"number"==typeof a[i]?a[i]:Math.max(T.parseValue(n.css(i)),T.parseValue(e.$("target").css(i)),n[i](),e.$("target")[i]()),n[i](o[i])})),r()&&o.width&&o.height>10},success:function(){Galleria.WEBKIT?i.setTimeout((function(){e._run()}),1):e._run()},error:function(){r()?Galleria.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+o.width+"px, height: "+o.height+"px.",!0):Galleria.raise("Could not extract a stage height from the CSS. Traced height: "+r()+"px.",!0)},timeout:1e4})})),this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]}),T.hide(this.$("counter").append(this.get("current"),n.createTextNode(" / "),this.get("total"))),this.setCounter("&#8211;"),T.hide(e.get("tooltip")),this.$("container").addClass(Galleria.TOUCH?"touch":"notouch"),t.each(Array(2),(function(i){var n=new Galleria.Picture;t(n.container).css({position:"absolute",top:0,left:0}).prepend(e._layers[i]=t(T.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]),e.$("images").append(n.container),e._controls[i]=n})),this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"}),this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"}),this.$("image-nav-right, image-nav-left").bind("click",(function(t){a.clicknext&&t.stopPropagation(),a.pauseOnInteraction&&e.pause(),t=/right/.test(this.className)?"next":"prev",e[t]()})),t.each(["info","counter","image-nav"],(function(t,i){!1===a["show"+i.substr(0,1).toUpperCase()+i.substr(1).replace(/-/,"")]&&T.moveOut(e.get(i.toLowerCase()))})),this.load(),a.keepSource||u||(this._target.innerHTML=""),this.get("errors")&&this.appendChild("target","errors"),this.appendChild("target","container"),a.carousel){var o=0,r=a.show;this.bind(Galleria.THUMBNAIL,(function(){this.updateCarousel(),++o==this.getDataLength()&&"number"==typeof r&&r>0&&this._carousel.follow(r)}))}return a.swipe&&(function(t){var i,n=[0,0],a=[0,0],o=!1,r=0,s="touchstart",l="touchmove",c="touchend",h=function(t){t.originalEvent.touches&&t.originalEvent.touches.length>1||(i=t.originalEvent.touches?t.originalEvent.touches[0]:t,a=[i.pageX,i.pageY],n[0]||(n=a),Math.abs(n[0]-a[0])>10&&t.preventDefault())},u=function(i){t.unbind(l,h),i.originalEvent.touches&&i.originalEvent.touches.length||o?o=!o:(T.timestamp()-r<1e3&&Math.abs(n[0]-a[0])>30&&Math.abs(n[1]-a[1])<100&&(i.preventDefault(),e[n[0]>a[0]?"next":"prev"]()),n=a=[0,0])};t.bind(s,(function(e){e.originalEvent.touches&&e.originalEvent.touches.length>1||(i=e.originalEvent.touches?e.originalEvent.touches[0]:e,r=T.timestamp(),n=a=[i.pageX,i.pageY],t.bind(l,h).one(c,u))}))}(e.$("images")),a.fullscreenDoubleTap&&this.$("stage").bind("touchstart",function(){var t,i,n,a,o,r;return function(s){r=Galleria.utils.timestamp(),i=(s.originalEvent.touches?s.originalEvent.touches[0]:s).pageX,n=(s.originalEvent.touches?s.originalEvent.touches[0]:s).pageY,r-t<500&&i-a<20&&n-o<20?(e.toggleFullscreen(),s.preventDefault(),e.$("stage").unbind("touchend",arguments.callee)):(t=r,a=i,o=n)}}())),T.optimizeTouch(this.get("container")),this},_createThumbnails:function(){this.get("total").innerHTML=this.getDataLength();var e,a,o,r,s,l=this,c=this._options,h=function(){var t=l.$("thumbnails").find(".active");return!!t.length&&t.find("img").attr("src")}(),u="string"==typeof c.thumbnails?c.thumbnails.toLowerCase():null,d=function(t){return n.defaultView&&n.defaultView.getComputedStyle?n.defaultView.getComputedStyle(o.container,null)[t]:s.css(t)},p=function(e,i,n){return function(){t(n).append(e),l.trigger({type:Galleria.THUMBNAIL,thumbTarget:e,index:i})}},g=function(e){c.pauseOnInteraction&&l.pause();var i=t(e.currentTarget).data("index");l.getIndex()!==i&&l.show(i),e.preventDefault()},f=function(e){e.scale({width:e.data.width,height:e.data.height,crop:c.thumbCrop,margin:c.thumbMargin,canvas:c.useCanvas,complete:function(e){var i,n,a=["left","top"];t.each(["Width","Height"],(function(o,r){i=r.toLowerCase(),!0===c.thumbCrop&&c.thumbCrop!==i||!c.thumbFit||((n={})[i]=e[i],t(e.container).css(n),(n={})[a[o]]=0,t(e.image).css(n)),e["outer"+r]=t(e.container)["outer"+r](!0)})),T.toggleQuality(e.image,!0===c.thumbQuality||"auto"===c.thumbQuality&&e.original.width<3*e.width),l.trigger({type:Galleria.THUMBNAIL,thumbTarget:e.image,index:e.data.order})}})};for(this._thumbnails=[],this.$("thumbnails").empty(),e=0;this._data[e];e++)r=this._data[e],!0===c.thumbnails?(o=new Galleria.Picture(e),a=r.thumb||r.image,this.$("thumbnails").append(o.container),s=t(o.container),o.data={width:T.parseValue(d("width")),height:T.parseValue(d("height")),order:e},c.thumbFit&&!0!==c.thumbCrop?s.css({width:0,height:0}):s.css({width:o.data.width,height:o.data.height}),o.load(a,f),"all"===c.preload&&o.preload(r.image)):"empty"===u||"numbers"===u?(o={container:T.create("galleria-image"),image:T.create("img","span"),ready:!0},"numbers"===u&&t(o.image).text(e+1),this.$("thumbnails").append(o.container),i.setTimeout(p(o.image,e,o.container),50+20*e)):o={container:null,image:null},t(o.container).add(c.keepSource&&c.linkSourceImages?r.original:null).data("index",e).bind(c.thumbEventType,g),h===a&&t(o.container).addClass("active"),this._thumbnails.push(o)},_run:function(){var e=this;e._createThumbnails(),T.wait({until:function(){return Galleria.OPERA&&e.$("stage").css("display","inline-block"),e._stageWidth=e.$("stage").width(),e._stageHeight=e.$("stage").height(),e._stageWidth&&e._stageHeight>50},success:function(){y.push(e),T.show(e.get("counter")),e._options.carousel&&e._carousel.bindControls(),e._options.autoplay&&(e.pause(),"number"==typeof e._options.autoplay&&(e._playtime=e._options.autoplay),e.trigger(Galleria.PLAY),e._playing=!0),e._firstrun?"number"==typeof e._options.show&&e.show(e._options.show):(e._firstrun=!0,e._options.clicknext&&!Galleria.TOUCH&&(t.each(e._data,(function(t,e){delete e.link})),e.$("stage").css({cursor:"pointer"}).bind("click",(function(){e._options.pauseOnInteraction&&e.pause(),e.next()}))),Galleria.History&&Galleria.History.change((function(t){isNaN(t)?i.history.go(-1):e.show(t,void 0,!0)})),t.each(Galleria.ready.callbacks,(function(){this.call(e,e._options)})),e.trigger(Galleria.READY),Galleria.theme.init.call(e,e._options),e._options.extend.call(e,e._options),/^[0-9]{1,4}$/.test(h)&&Galleria.History?e.show(h,void 0,!0):e._data[e._options.show]&&e.show(e._options.show))},error:function(){Galleria.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+e._stageWidth+"px, height: "+e._stageHeight+"px.",!0)}})},load:function(e,i,n){var a=this;return this._data=[],this._thumbnails=[],this.$("thumbnails").empty(),"function"==typeof i&&(n=i,i=null),e=e||this._options.dataSource,i=i||this._options.dataSelector,n=n||this._options.dataConfig,/^function Object/.test(e.constructor)&&(e=[e]),e.constructor===Array?(this.validate(e)?(this._data=e,this._parseData().trigger(Galleria.DATA)):Galleria.raise("Load failed: JSON Array not valid."),this):(t(e).find(i).each((function(e,i){var o={},r=(s=(i=t(i)).parent()).attr("href"),s=s.attr("rel");r&&(o.image=o.big=r),s&&(o.big=s),a._data.push(t.extend({title:i.attr("title")||"",thumb:i.attr("src"),image:i.attr("src"),big:i.attr("src"),description:i.attr("alt")||"",link:i.attr("longdesc"),original:i.get(0)},o,n(i)))})),this.getDataLength()?this.trigger(Galleria.DATA):Galleria.raise("Load failed: no data found."),this)},_parseData:function(){var e=this;return t.each(this._data,(function(t,i){"thumb"in i==!1&&(e._data[t].thumb=i.image),!1 in i&&(e._data[t].big=i.image)})),this},splice:function(){return Array.prototype.splice.apply(this._data,T.array(arguments)),this._parseData()._createThumbnails()},push:function(){return Array.prototype.push.apply(this._data,T.array(arguments)),this._parseData()._createThumbnails()},_getActive:function(){return this._controls.getActive()},validate:function(){return!0},bind:function(t,e){return t=f(t),this.$("container").bind(t,this.proxy(e)),this},unbind:function(t){return t=f(t),this.$("container").unbind(t),this},trigger:function(e){return e="object"==typeof e?t.extend(e,{scope:this}):{type:f(e),scope:this},this.$("container").trigger(e),this},addIdleState:function(t,e){return this._idle.add.apply(this._idle,T.array(arguments)),this},removeIdleState:function(t){return this._idle.remove.apply(this._idle,T.array(arguments)),this},enterIdleMode:function(){return this._idle.hide(),this},exitIdleMode:function(){return this._idle.showAll(),this},enterFullscreen:function(t){return this._fullscreen.enter.apply(this,T.array(arguments)),this},exitFullscreen:function(t){return this._fullscreen.exit.apply(this,T.array(arguments)),this},toggleFullscreen:function(t){return this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,T.array(arguments)),this},bindTooltip:function(t,e){return this._tooltip.bind.apply(this._tooltip,T.array(arguments)),this},defineTooltip:function(t,e){return this._tooltip.define.apply(this._tooltip,T.array(arguments)),this},refreshTooltip:function(t){return this._tooltip.show.apply(this._tooltip,T.array(arguments)),this},openLightbox:function(){return this._lightbox.show.apply(this._lightbox,T.array(arguments)),this},closeLightbox:function(){return this._lightbox.hide.apply(this._lightbox,T.array(arguments)),this},getActiveImage:function(){return this._getActive().image||void 0},getActiveThumb:function(){return this._thumbnails[this._active].image||void 0},getMousePosition:function(t){return{x:t.pageX-this.$("container").offset().left,y:t.pageY-this.$("container").offset().top}},addPan:function(e){if(!1!==this._options.imageCrop){e=t(e||this.getActiveImage());var i=this,n=e.width()/2,a=e.height()/2,o=parseInt(e.css("left"),10),r=parseInt(e.css("top"),10),s=o||0,l=r||0,c=0,h=0,d=!1,p=T.timestamp(),g=0,f=0,m=function(t,i,n){t>0&&(f=Math.round(Math.max(-1*t,Math.min(0,i))),g!==f)&&(g=f,8===u?e.parent()["scroll"+n](-1*f):((t={})[n.toLowerCase()]=f,e.css(t)))},y=function(t){T.timestamp()-p<50||(d=!0,n=i.getMousePosition(t).x,a=i.getMousePosition(t).y)};return 8===u&&(e.parent().scrollTop(-1*l).scrollLeft(-1*s),e.css({top:0,left:0})),this.$("stage").unbind("mousemove",y).bind("mousemove",y),T.addTimer("pan",(function(){d&&(c=e.width()-i._stageWidth,h=e.height()-i._stageHeight,o=n/i._stageWidth*c*-1,r=a/i._stageHeight*h*-1,s+=(o-s)/i._options.imagePanSmoothness,l+=(r-l)/i._options.imagePanSmoothness,m(h,l,"Top"),m(c,s,"Left"))}),50,!0),this}},proxy:function(t,e){return"function"!=typeof t?function(){}:(e=e||this,function(){return t.apply(e,T.array(arguments))})},removePan:function(){return this.$("stage").unbind("mousemove"),T.clearTimer("pan"),this},addElement:function(e){var i=this._dom;return t.each(T.array(arguments),(function(t,e){i[e]=T.create("galleria-"+e)})),this},attachKeyboard:function(t){return this._keyboard.attach.apply(this._keyboard,T.array(arguments)),this},detachKeyboard:function(){return this._keyboard.detach.apply(this._keyboard,T.array(arguments)),this},appendChild:function(t,e){return this.$(t).append(this.get(e)||e),this},prependChild:function(t,e){return this.$(t).prepend(this.get(e)||e),this},remove:function(t){return this.$(T.array(arguments).join(",")).remove(),this},append:function(t){var e,i;for(e in t)if(t.hasOwnProperty(e))if(t[e].constructor===Array)for(i=0;t[e][i];i++)this.appendChild(e,t[e][i]);else this.appendChild(e,t[e]);return this},_scaleImage:function(e,i){if(e=e||this._controls.getActive()){var n,a=function(e){t(e.container).children(":first").css({top:Math.max(0,T.parseValue(e.image.style.top)),left:Math.max(0,T.parseValue(e.image.style.left)),width:T.parseValue(e.image.width),height:T.parseValue(e.image.height)})};i=t.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition},i);return this._options.layerFollow&&!0!==this._options.imageCrop?"function"==typeof i.complete?(n=i.complete,i.complete=function(){n.call(e,e),a(e)}):i.complete=a:t(e.container).children(":first").css({top:0,left:0}),e.scale(i),this}},updateCarousel:function(){return this._carousel.update(),this},rescale:function(t,e,i){var n=this;"function"==typeof t&&(i=t,t=void 0);var a=function(){n._stageWidth=t||n.$("stage").width(),n._stageHeight=e||n.$("stage").height(),n._scaleImage(),n._options.carousel&&n.updateCarousel(),n.trigger(Galleria.RESCALE),"function"==typeof i&&i.call(n)};return!Galleria.WEBKIT||t||e?a.call(n):T.addTimer("scale",a,10),this},refreshImage:function(){return this._scaleImage(),this._options.imagePan&&this.addPan(),this},show:function(t,e,i){if(!1!==t&&(this._options.queue||!this._queue.stalled)){if(t=Math.max(0,Math.min(parseInt(t,10),this.getDataLength()-1)),e=void 0!==e?!!e:t<this.getIndex(),i||!Galleria.History)return this._active=t,Array.prototype.push.call(this._queue,{index:t,rewind:e}),this._queue.stalled||this._show(),this;Galleria.History.set(t.toString())}},_show:function(){var e=this,n=this._queue[0],a=this.getData(n.index);if(a){var o=this.isFullscreen()&&"big"in a?a.big:a.image,r=this._controls.getActive(),s=this._controls.getNext(),l=s.isCached(o),c=this._thumbnails[n.index],h=function(n,a,o,r,s){return function(){e._queue.stalled=!1,T.toggleQuality(a.image,e._options.imageQuality),e._layers[e._controls.active].innerHTML="",t(o.container).css({zIndex:0,opacity:0}).show(),t(a.container).css({zIndex:1}).show(),e._controls.swap(),e._options.imagePan&&e.addPan(a.image),(n.link||e._options.lightbox)&&t(a.image).css({cursor:"pointer"}).bind("mouseup",(function(){n.link?e._options.popupLinks?i.open(n.link,"_blank"):i.location.href=n.link:e.openLightbox()})),Array.prototype.shift.call(e._queue),e._queue.length&&e._show(),e._playCheck(),e.trigger({type:Galleria.IMAGE,index:r.index,imageTarget:a.image,thumbTarget:s.image})}}(a,s,r,n,c);if(this._options.carousel&&this._options.carouselFollow&&this._carousel.follow(n.index),this._options.preload){var u,d,p,g=this.getNext();try{for(d=this._options.preload;d>0;d--)u=new Galleria.Picture,p=e.getData(g),u.preload(this.isFullscreen()&&"big"in p?p.big:p.image),g=e.getNext(g)}catch(t){}}T.show(s.container),t(e._thumbnails[n.index].container).addClass("active").siblings(".active").removeClass("active"),e.trigger({type:Galleria.LOADSTART,cached:l,index:n.index,rewind:n.rewind,imageTarget:s.image,thumbTarget:c.image}),s.load(o,(function(i){var o=t(e._layers[1-e._controls.active]).html(a.layer||"").hide();e._scaleImage(i,{complete:function(i){"image"in r&&T.toggleQuality(r.image,!1),T.toggleQuality(i.image,!1),e._queue.stalled=!0,e.removePan(),e.setInfo(n.index),e.setCounter(n.index),a.layer&&(o.show(),a.link||e._options.clicknext)&&o.css("cursor","pointer").one("click",(function(){a.link?t(i.image).trigger("mouseup"):e.$("stage").trigger("click")})),e.trigger({type:Galleria.LOADFINISH,cached:l,index:n.index,rewind:n.rewind,imageTarget:i.image,thumbTarget:e._thumbnails[n.index].image});var s=e._options.transition;t.each({initial:null===r.image,touch:Galleria.TOUCH,fullscreen:e.isFullscreen()},(function(t,i){if(i&&void 0!==e._options[t+"Transition"])return s=e._options[t+"Transition"],!1})),s in k==!1?h():k[s].call(e,{prev:r.container,next:i.container,rewind:n.rewind,speed:e._options.transitionSpeed||400},h)}})}))}},getNext:function(t){return(t="number"==typeof t?t:this.getIndex())===this.getDataLength()-1?0:t+1},getPrev:function(t){return 0===(t="number"==typeof t?t:this.getIndex())?this.getDataLength()-1:t-1},next:function(){return this.getDataLength()>1&&this.show(this.getNext(),!1),this},prev:function(){return this.getDataLength()>1&&this.show(this.getPrev(),!0),this},get:function(t){return t in this._dom?this._dom[t]:null},getData:function(t){return t in this._data?this._data[t]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return"number"==typeof this._active&&this._active},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(t){return void 0===t?this._options:this._options[t]},setOptions:function(e,i){return"object"==typeof e?t.extend(this._options,e):this._options[e]=i,this},play:function(t){return this._playing=!0,this._playtime=t||this._playtime,this._playCheck(),this.trigger(Galleria.PLAY),this},pause:function(){return this._playing=!1,this.trigger(Galleria.PAUSE),this},playToggle:function(t){return this._playing?this.pause():this.play(t)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var t=this,e=0,i=T.timestamp(),n="play"+this._id;if(this._playing){T.clearTimer(n);var a=function(){(e=T.timestamp()-i)>=t._playtime&&t._playing?(T.clearTimer(n),t.next()):t._playing&&(t.trigger({type:Galleria.PROGRESS,percent:Math.ceil(e/t._playtime*100),seconds:Math.floor(e/1e3),milliseconds:e}),T.addTimer(n,a,20))};T.addTimer(n,a,20)}},setPlaytime:function(t){return this._playtime=t,this},setIndex:function(t){return this._active=t,this},setCounter:function(t){if("number"==typeof t?t++:void 0===t&&(t=this.getIndex()+1),this.get("current").innerHTML=t,u){var e=(t=this.$("counter")).css("opacity");1===parseInt(e,10)?T.removeAlpha(t[0]):this.$("counter").css("opacity",e)}return this},setInfo:function(e){var i=this,n=this.getData(e);return t.each(["title","description"],(function(t,e){var a=i.$("info-"+e);n[e]?a[n[e].length?"show":"hide"]().html(n[e]):a.empty().hide()})),this},hasInfo:function(t){var e,i="title description".split(" ");for(e=0;i[e];e++)if(this.getData(t)[i[e]])return!0;return!1},jQuery:function(e){var i=this,n=[];t.each(e.split(","),(function(e,a){a=t.trim(a),i.get(a)&&n.push(a)}));var a=t(i.get(n.shift()));return t.each(n,(function(t,e){a=a.add(i.get(e))})),a},$:function(t){return this.jQuery.apply(this,T.array(arguments))}},t.each(p,(function(t,e){var i=/_/.test(e)?e.replace(/_/g,""):e;Galleria[e.toUpperCase()]="galleria."+i})),t.extend(Galleria,{IE9:9===u,IE8:8===u,IE7:7===u,IE6:6===u,IE:u,WEBKIT:/webkit/.test(c),SAFARI:/safari/.test(c),CHROME:/chrome/.test(c),QUIRK:u&&n.compatMode&&"BackCompat"===n.compatMode,MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!i.opera,IPHONE:/iphone/.test(c),IPAD:/ipad/.test(c),ANDROID:/android/.test(c),TOUCH:"ontouchstart"in n}),Galleria.addTheme=function(e){e.name||Galleria.raise("No theme name specified"),e.defaults="object"!=typeof e.defaults?{}:g(e.defaults);var i=!1;return"string"==typeof e.css?(t("link").each((function(t,n){if(RegExp(e.css).test(n.href))return i=!0,w(e),!1})),i||t("script").each((function(t,n){RegExp("galleria\\."+e.name.toLowerCase()+"\\.").test(n.src)&&(i=n.src.replace(/[^\/]*$/,"")+e.css,T.addTimer("css",(function(){T.loadCSS(i,"galleria-theme",(function(){w(e)}))}),1))})),i||Galleria.raise("No theme CSS loaded")):w(e),e},Galleria.loadTheme=function(e,n){var a=y.length,o=i.setTimeout((function(){Galleria.raise("Theme at "+e+" could not load, check theme path.",!0)}),5e3);Galleria.theme=void 0,T.loadScript(e,(function(){if(i.clearTimeout(o),a){var e=[];t.each(Galleria.get(),(function(i,a){var o=t.extend(a._original.options,{data_source:a._data},n);a.$("container").remove();var r=new Galleria;r._id=a._id,r.init(a._original.target,o),e.push(r)})),y=e}}))},Galleria.get=function(t){return v[t]?v[t]:"number"!=typeof t?v:void Galleria.raise("Gallery index "+t+" not found")},Galleria.addTransition=function(t,e){k[t]=e},Galleria.utils=T,Galleria.log="console"in i&&"log"in i.console?i.console.log:function(){i.alert(T.array(arguments).join(", "))},Galleria.ready=function(e){t.each(y,(function(t,i){e.call(i,i._options)})),Galleria.ready.callbacks.push(e)},Galleria.ready.callbacks=[],Galleria.raise=function(e,i){var n=i?"Fatal error":"Error",a=function(e){var a='<div style="padding:4px;margin:0 0 2px;background:#'+(i?"811":"222")+'";>'+(i?"<strong>"+n+": </strong>":"")+e+"</div>";t.each(v,(function(){var t=this.$("errors"),e=this.$("target");t.length||(e.css("position","relative"),t=this.addElement("errors").appendChild("target","errors").$("errors").css({color:"#fff",position:"absolute",top:0,left:0,zIndex:1e5})),t.append(a)}))};if(r){if(a(e),i)throw Error(n+": "+e)}else i&&!b&&(b=!0,i=!1,a("Image gallery could not load."))},Galleria.version=1.26,Galleria.requires=function(t,e){Galleria.version<t&&Galleria.raise(e||"You need to upgrade Galleria to version "+t+" to use one or more components.",!0)},Galleria.Picture=function(e){this.id=e||null,this.image=null,this.container=T.create("galleria-image"),t(this.container).css({overflow:"hidden",position:"relative"}),this.original={width:0,height:0},this.ready=!1,this.tid=null},Galleria.Picture.prototype={cache:{},show:function(){T.show(this.image)},hide:function(){T.moveOut(this.image)},clear:function(){this.image=null},isCached:function(t){return!!this.cache[t]},preload:function(e){t(new Image).load(function(t,e){return function(){e[t]=t}}(e,this.cache)).attr("src",e)},load:function(e,n){this.tid=i.setTimeout(function(t){return function(){Galleria.raise("Image not loaded in "+Math.round(s/1e3)+" seconds: "+t)}}(e),s),this.image=new Image;var a=!1,o=t(this.container),r=t(this.image),c=function(e,n,a){return function(){var o=function(){t(this).unbind("load"),e.original={height:this.height,width:this.width},e.cache[a]=a,i.clearTimeout(e.tid),"function"==typeof n&&i.setTimeout((function(){n.call(e,e)}),1)};this.width&&this.height?o.call(this):i.setTimeout(function(t){return function(){t.width&&t.height?o.call(t):Galleria.raise("Could not extract width/height from image: "+t.src+". Traced measures: width:"+t.width+"px, height: "+t.height+"px.")}}(this),2)}}(this,n,e);return o.find("img").remove(),r.css("display","block").appendTo(this.container),T.hide(this.image),this.cache[e]?(t(this.image).load(c).attr("src",e),this.container):(t(this.image).load(c).error((function(){a?l?t(this).attr("src",l):Galleria.raise("Image not found: "+e):(a=!0,i.setTimeout(function(t,e){return function(){t.attr("src",e+"?"+T.timestamp())}}(t(this),e),50))})).attr("src",e),this.container)},scale:function(e){if(e=t.extend({width:0,height:0,min:void 0,max:void 0,margin:0,complete:function(){},position:"center",crop:!1,canvas:!1},e),!this.image)return this.container;var i,n,a,o=this,r=t(o.container);return T.wait({until:function(){return i=e.width||r.width()||T.parseValue(r.css("width")),n=e.height||r.height()||T.parseValue(r.css("height")),i&&n},success:function(){var r=(i-2*e.margin)/o.original.width,s=(n-2*e.margin)/o.original.height,l={true:Math.max(r,s),width:r,height:s,false:Math.min(r,s)}[e.crop.toString()];r="";e.max&&(l=Math.min(e.max,l)),e.min&&(l=Math.max(e.min,l)),t.each(["width","height"],(function(e,i){t(o.image)[i](o[i]=o.image[i]=Math.round(o.original[i]*l))})),t(o.container).width(i).height(n),e.canvas&&_&&(_.elem.width=o.width,_.elem.height=o.height,r=o.image.src+":"+o.width+"x"+o.height,o.image.src=_.cache[r]||function(t){_.context.drawImage(o.image,0,0,o.original.width*l,o.original.height*l);try{return a=_.elem.toDataURL(),_.length+=a.length,_.cache[t]=a}catch(t){return o.image.src}}(r));var c={},h={},u=(r=function(e,i,n){var a=0;return/\%/.test(e)?(e=parseInt(e,10)/100,i=o.image[i]||t(o.image)[i](),a=Math.ceil(-1*i*e+n*e)):a=T.parseValue(e),a},{top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}});t.each(e.position.toLowerCase().split(" "),(function(t,e){"center"===e&&(e="50%"),c[t?"top":"left"]=e})),t.each(c,(function(e,i){u.hasOwnProperty(i)&&t.extend(h,u[i])})),c=c.top?t.extend(c,h):h,c=t.extend({top:"50%",left:"50%"},c),t(o.image).css({position:"absolute",top:r(c.top,"height",n),left:r(c.left,"width",i)}),o.show(),o.ready=!0,e.complete.call(o,o)},error:function(){Galleria.raise("Could not scale image: "+o.image.src)},timeout:1e3}),this}},t.extend(t.easing,{galleria:function(t,e,i,n,a){return(e/=a/2)<1?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i},galleriaIn:function(t,e,i,n,a){return n*(e/=a)*e+i},galleriaOut:function(t,e,i,n,a){return-n*(e/=a)*(e-2)+i}}),t.fn.galleria=function(e){return this.each((function(){t(this).data("galleria",(new Galleria).init(this,e))}))}}(jQuery);